#!/usr/bin/env ruby

require 'net/http'
require 'uri'

re = /.*http:\/\/([^\/]*)\/([^\/]*).*/
m = re.match `git remote show origin | grep 'Fetch URL'`

host = m[1]
uid = m[2]

uri = URI.parse "http://#{ host }/faye"
uri.port = 9292

res = Net::HTTP.post_form uri, :message => "{\"channel\":\"/#{ uid }/startup\", \"data\":\"true\"}"

puts "Starting Tutor..."
puts "Open http://#{ host }/#{ uid }/pset1 in your browser to get your learning on!"

loop do
  sleep 5
end

